<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>스마트 장바구니 디자인 시안</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
        }
        .modal-backdrop {
            transition: opacity 0.3s ease;
        }
        .modal-content {
            transition: transform 0.3s ease, opacity 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- 스마트 장바구니 모달 -->
    <div id="smart-cart-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 modal-backdrop opacity-0 pointer-events-none">
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-md modal-content transform scale-95 opacity-0">
            <div class="p-6">
                <div class="flex items-center mb-4">
                    <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                        <svg class="w-6 h-6 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <h2 class="text-xl font-bold text-gray-800">상품 수량 안내</h2>
                </div>
                
                <p class="text-gray-600 mb-4">
                    <strong class="font-semibold text-gray-800">'깐마늘_1kg'</strong> 상품은 현재 <strong class="font-semibold text-blue-600">2개</strong>가 바로 배송 가능한 상태입니다.
                </p>
                <p class="text-gray-600 mb-6">
                    부족한 수량 <strong class="font-semibold text-gray-800" id="shortage-quantity-text">8개</strong>는 시세가 기준으로 준비해 함께 보내드릴까요?
                </p>

                <div class="bg-gray-50 p-4 rounded-lg space-y-3 mb-6 border">
                    <div class="flex justify-between items-center text-sm">
                        <span class="text-gray-600">바로 배송 가능:</span>
                        <span class="font-semibold text-gray-800">2개 x 9,300원</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600 text-sm">시세가 적용:</span>
                        <div class="flex items-center border bg-white rounded-md">
                            <button onclick="updateModalQuantity(-1)" class="px-3 py-1 text-lg text-gray-600 hover:bg-gray-100 rounded-l-md">-</button>
                            <input type="number" id="market-price-input" value="8" class="w-12 text-center font-semibold border-none bg-transparent focus:ring-0" oninput="updateShortageText()">
                            <button onclick="updateModalQuantity(1)" class="px-3 py-1 text-lg text-gray-600 hover:bg-gray-100 rounded-r-md">+</button>
                        </div>
                        <span class="font-semibold text-gray-800 text-sm">x 9,500원 (예상)</span>
                    </div>
                </div>

                <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                    <button onclick="closeModal(false)" class="w-full px-4 py-3 bg-gray-200 text-gray-800 rounded-lg font-semibold hover:bg-gray-300 transition-colors col-span-1 sm:col-span-3">취소</button>
                    <button onclick="addInStockToCart()" class="w-full px-4 py-3 bg-white text-blue-600 border border-blue-600 rounded-lg font-semibold hover:bg-blue-50 transition-colors col-span-1 sm:col-span-1">2개만 담기</button>
                    <button onclick="addBothToCart()" class="w-full px-4 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors col-span-1 sm:col-span-2">네, 모두 담아주세요</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 메인 컨텐츠 -->
    <div class="max-w-xl mx-auto bg-white min-h-screen">
        <header class="p-4 border-b text-center sticky top-0 bg-white z-10">
            <h1 class="text-xl font-bold">빠른주문</h1>
        </header>
        <main class="p-4">
            <div id="cart-items" class="space-y-2">
                <!-- 상품 아이템: 깐마늘 (재고 제한) -->
                <div id="product-garlic" class="flex items-center justify-between p-3 bg-gray-50 rounded-lg" data-name="깐마늘_1kg" data-price="9300" data-market-price="9500">
                    <span class="font-semibold text-gray-800">깐마늘_1kg</span>
                    <div class="flex items-center space-x-4">
                        <span class="font-bold text-lg text-gray-900">9,300원</span>
                        <div class="flex items-center border bg-white rounded-md">
                            <button onclick="updateQuantity('garlic', -1)" class="px-3 py-1 text-lg text-gray-600 hover:bg-gray-100 rounded-l-md">-</button>
                            <input type="text" id="quantity-garlic" value="0" class="w-10 text-center font-semibold border-none bg-transparent focus:ring-0" readonly>
                            <button onclick="updateQuantity('garlic', 1)" class="px-3 py-1 text-lg text-gray-600 hover:bg-gray-100 rounded-r-md">+</button>
                        </div>
                    </div>
                </div>
                <!-- 기타 상품 아이템 -->
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <span class="font-semibold text-gray-800">깍두기김치_얼음골_국내산_10...</span>
                    <div class="flex items-center space-x-4"><span class="font-bold text-lg text-gray-900">29,000원</span><div class="flex items-center border bg-white rounded-md"><button class="px-3 py-1 text-lg text-gray-600 hover:bg-gray-100 rounded-l-md">-</button><input type="text" value="0" class="w-10 text-center font-semibold border-none bg-transparent focus:ring-0" readonly><button class="px-3 py-1 text-lg text-gray-600 hover:bg-gray-100 rounded-r-md">+</button></div></div>
                </div>
                 <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <span class="font-semibold text-gray-800">양파_20kg망</span>
                    <div class="flex items-center space-x-4"><span class="font-bold text-lg text-gray-900">27,800원</span><div class="flex items-center border bg-white rounded-md"><button class="px-3 py-1 text-lg text-gray-600 hover:bg-gray-100 rounded-l-md">-</button><input type="text" value="0" class="w-10 text-center font-semibold border-none bg-transparent focus:ring-0" readonly><button class="px-3 py-1 text-lg text-gray-600 hover:bg-gray-100 rounded-r-md">+</button></div></div>
                </div>
            </div>
        </main>
    </div>

    <script>
        const modal = document.getElementById('smart-cart-modal');
        const modalContent = modal.querySelector('.modal-content');
        const cartItemsContainer = document.getElementById('cart-items');
        const stockLimit = 2;

        function showModal(requestedQuantity) {
            const shortage = requestedQuantity - stockLimit;
            document.getElementById('shortage-quantity-text').textContent = shortage + '개';
            document.getElementById('market-price-input').value = shortage;
            
            modal.classList.remove('pointer-events-none', 'opacity-0');
            modalContent.classList.remove('scale-95', 'opacity-0');
        }

        function closeModal(resetQuantity = true) {
             if (resetQuantity) {
                const garlicInput = document.getElementById('quantity-garlic');
                if(garlicInput) garlicInput.value = 0;
            }
            modalContent.classList.add('scale-95', 'opacity-0');
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('pointer-events-none'), 300);
        }

        function updateQuantity(item, change) {
            const input = document.getElementById(`quantity-${item}`);
            let newValue = parseInt(input.value) + change;
            if (newValue < 0) newValue = 0;

            if (item === 'garlic' && newValue > stockLimit) {
                showModal(newValue);
                return;
            }
            input.value = newValue;
        }

        function updateModalQuantity(change) {
            const input = document.getElementById('market-price-input');
            let newValue = parseInt(input.value) + change;
            if (newValue < 1) newValue = 1;
            input.value = newValue;
            updateShortageText();
        }
        
        function updateShortageText() {
             const input = document.getElementById('market-price-input');
             document.getElementById('shortage-quantity-text').textContent = input.value + '개';
        }

        function createCartItemHTML(name, quantity, price, isMarketPrice = false) {
            const formattedPrice = new Intl.NumberFormat('ko-KR').format(price);
            const itemName = isMarketPrice ? `${name} <span class="text-sm font-medium text-green-600">(시세)</span>` : name;
            return `
                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                    <div><span class="font-semibold text-gray-800">${itemName}</span></div>
                    <div class="flex items-center space-x-4">
                        <span class="font-bold text-lg text-gray-900">${formattedPrice}원</span>
                        <div class="flex items-center border bg-white rounded-md">
                           <span class="px-5 py-1 text-lg font-semibold">${quantity}</span>
                        </div>
                    </div>
                </div>`;
        }

        function addBothToCart() {
            const garlicProduct = document.getElementById('product-garlic');
            const name = garlicProduct.dataset.name;
            const price = parseInt(garlicProduct.dataset.price);
            const marketPrice = parseInt(garlicProduct.dataset.marketPrice);
            const marketQuantity = parseInt(document.getElementById('market-price-input').value);

            // 기존 상품 라인 교체
            const inStockHTML = createCartItemHTML(name, stockLimit, price);
            const marketPriceHTML = createCartItemHTML(name, marketQuantity, marketPrice, true);
            garlicProduct.outerHTML = inStockHTML + marketPriceHTML;

            closeModal(false);
        }

        function addInStockToCart() {
            const garlicProduct = document.getElementById('product-garlic');
            const name = garlicProduct.dataset.name;
            const price = parseInt(garlicProduct.dataset.price);
            
            const inStockHTML = createCartItemHTML(name, stockLimit, price);
            garlicProduct.outerHTML = inStockHTML;

            closeModal(false);
        }

        modal.addEventListener('click', (event) => (event.target === modal) && closeModal());
    </script>
</body>
</html>

